<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>T·∫°o ƒê∆°n H√†ng M·ªõi - Staff</title>
    <link rel="stylesheet" href="../css/styles.css">
    <link rel="stylesheet" href="../css/dashboard.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/lucide/0.263.1/lucide.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <a href="../index.html">NTT Express</a>
                </div>
                <nav class="nav">
                    <ul class="nav-list">
                        <li><a href="staff-dashboard.html" class="nav-link">Dashboard</a></li>
                        <li><a href="staff-orders.html" class="nav-link">Qu·∫£n L√Ω ƒê∆°n H√†ng</a></li>
                        <li><a href="staff-track.html" class="nav-link">Theo D√µi Giao H√†ng</a></li>
                        <li><a href="staff-stats.html" class="nav-link">Th·ªëng K√™</a></li>
                    </ul>
                </nav>
                <div class="header-actions">
                    <div class="user-menu">
                        <span class="user-name" id="userName">Staff</span>
                        <button class="btn btn-secondary" onclick="logout()">ƒêƒÉng Xu·∫•t</button>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
        <div class="container">
            <div class="page-header">
                <h1>T·∫°o ƒê∆°n H√†ng M·ªõi</h1>
                <p>T·∫°o ƒë∆°n h√†ng m·ªõi v√† t·ª± ƒë·ªông ƒë∆∞·ª£c ph√¢n c√¥ng cho b·∫°n</p>
            </div>

            <div class="form-section">
                <form id="createOrderForm">
                    <!-- Th√¥ng tin ng∆∞·ªùi g·ª≠i -->
                    <h2>Th√¥ng Tin Ng∆∞·ªùi G·ª≠i</h2>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">T√™n ng∆∞·ªùi g·ª≠i *</label>
                            <input type="text" name="sender_name" class="form-input" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">S·ªë ƒëi·ªán tho·∫°i *</label>
                            <input type="tel" name="sender_phone" class="form-input" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">ƒê·ªãa ch·ªâ g·ª≠i *</label>
                        <input type="text" name="sender_address" class="form-input" required>
                    </div>

                    <!-- Th√¥ng tin ng∆∞·ªùi nh·∫≠n -->
                    <h2>Th√¥ng Tin Ng∆∞·ªùi Nh·∫≠n</h2>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">T√™n ng∆∞·ªùi nh·∫≠n *</label>
                            <input type="text" name="receiver_name" class="form-input" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">S·ªë ƒëi·ªán tho·∫°i *</label>
                            <input type="tel" name="receiver_phone" class="form-input" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">ƒê·ªãa ch·ªâ nh·∫≠n *</label>
                        <input type="text" name="receiver_address" class="form-input" required>
                    </div>

                    <!-- Th√¥ng tin h√†ng h√≥a -->
                    <h2>Th√¥ng Tin H√†ng H√≥a</h2>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Tr·ªçng l∆∞·ª£ng (kg) *</label>
                            <input type="number" name="package_weight" class="form-input" step="0.1" min="0.1" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">K√≠ch th∆∞·ªõc (cm)</label>
                            <input type="text" name="package_dimensions" class="form-input" placeholder="D√†i x R·ªông x Cao">
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">M√¥ t·∫£ h√†ng h√≥a</label>
                        <textarea name="package_description" class="form-input" rows="3" placeholder="M√¥ t·∫£ chi ti·∫øt v·ªÅ h√†ng h√≥a..."></textarea>
                    </div>

                    <!-- Th√¥ng tin v·∫≠n chuy·ªÉn -->
                    <h2>Th√¥ng Tin V·∫≠n Chuy·ªÉn</h2>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Ph√≠ v·∫≠n chuy·ªÉn (VNƒê) *</label>
                            <input type="number" name="shipping_fee" class="form-input" min="0" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Ng√†y giao d·ª± ki·∫øn</label>
                            <input type="date" name="estimated_delivery_date" class="form-input">
                        </div>
                    </div>

                    <!-- Th√¥ng b√°o -->
                    <div class="info-box">
                        <h3>üìã L∆∞u √Ω</h3>
                        <p>‚Ä¢ ƒê∆°n h√†ng s·∫Ω t·ª± ƒë·ªông ƒë∆∞·ª£c ph√¢n c√¥ng cho b·∫°n</p>
                        <p>‚Ä¢ B·∫°n s·∫Ω nh·∫≠n th√¥ng b√°o khi c√≥ ƒë∆°n h√†ng m·ªõi</p>
                        <p>‚Ä¢ C√≥ th·ªÉ theo d√µi tr·∫°ng th√°i ƒë∆°n h√†ng trong ph·∫ßn "Qu·∫£n L√Ω ƒê∆°n H√†ng"</p>
                    </div>

                    <!-- N√∫t t·∫°o ƒë∆°n h√†ng -->
                    <div class="form-group">
                        <button type="submit" class="btn btn-success btn-full" id="submitBtn">
                            <span class="btn-text">
                                <i data-lucide="plus"></i>
                                T·∫°o ƒê∆°n H√†ng
                            </span>
                            <span class="btn-loading" style="display: none;">
                                <div class="loading-spinner"></div>
                                ƒêang t·∫°o...
                            </span>
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </main>

    <script src="../js/lucide.min.js"></script>
    <script src="../js/api.js"></script>
    <script src="../js/script.js"></script>
    <script>
        // Initialize Lucide icons
        lucide.createIcons();

        // Check authentication
        auth.redirectIfNotStaff();

        // Load user info
        const user = JSON.parse(localStorage.getItem('user') || '{}');
        document.getElementById('userName').textContent = user.full_name || 'Staff';

        // Handle form submission
        document.getElementById('createOrderForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const submitBtn = document.getElementById('submitBtn');
            const btnText = submitBtn.querySelector('.btn-text');
            const btnLoading = submitBtn.querySelector('.btn-loading');
            
            // Show loading state
            btnText.style.display = 'none';
            btnLoading.style.display = 'inline-flex';
            submitBtn.disabled = true;

            try {
                const formData = new FormData(e.target);
                const orderData = Object.fromEntries(formData.entries());
                
                const response = await api.createOrder(orderData);
                
                if (response.success) {
                    ui.showSuccess('T·∫°o ƒë∆°n h√†ng th√†nh c√¥ng!');
                    
                    // Reset form
                    e.target.reset();
                    
                    // Redirect to orders page after 2 seconds
                    setTimeout(() => {
                        window.location.href = 'staff-orders.html';
                    }, 2000);
                } else {
                    ui.showError(response.message || 'T·∫°o ƒë∆°n h√†ng th·∫•t b·∫°i');
                }
            } catch (error) {
                ui.showError(error.message || 'C√≥ l·ªói x·∫£y ra khi t·∫°o ƒë∆°n h√†ng');
            } finally {
                // Reset button state
                btnText.style.display = 'inline-flex';
                btnLoading.style.display = 'none';
                submitBtn.disabled = false;
            }
        });

        function logout() {
            api.logout();
        }
    </script>
</body>
</html> 